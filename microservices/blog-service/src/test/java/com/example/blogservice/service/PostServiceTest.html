package com.example.blogservice.service;

import com.example.blogservice.model.Post;
import com.example.blogservice.model.PostStatus;
import com.example.blogservice.model.dto.PostCreateDto;
import com.example.blogservice.repository.PostRepository;
import org.junit.Assert;
import org.junit.jupiter.api.AfterEach;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.extension.ExtendWith;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.junit.jupiter.MockitoExtension;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.mock.mockito.MockBean;

import java.time.Instant;

import static org.mockito.ArgumentMatchers.any;
import static org.mockito.Mockito.*;
import static org.junit.jupiter.api.Assertions.assertEquals;
@ExtendWith(MockitoExtension.class)
public class PostServiceTest {

    @MockBean
    private PostRepository postRepository;

    @InjectMocks
    private PostService postService;

//    private Product product1;
//    private Product product2;
//    List<Product> productList;

    @BeforeEach
    public void setUp() {
//        productList = new ArrayList<>();
//        product1 = new Product(1, "bread",20);
//        product2 = new Product(2, "jam",200);
//        productList.add(product1);
//        productList.add(product2);
    }

    @AfterEach
    public void tearDown() {
//        product1 = product2 = null;
//        productList = null;
    }


    @Test
    public void saveTest() {

        String principal = "Principal";
        PostCreateDto postCreateDto = new PostCreateDto("PostCreateDto", "Content", PostStatus.PUBLISH);

        Post post = new Post("PostCreateDto", "Content", PostStatus.PUBLISH, Instant.now(),Instant.now(), principal);

        when(postRepository.save(any())).thenReturn(post);


        Post ret = postService.save(principal, postCreateDto);

        assertEquals(post, ret);


    }






//    @Test
//    public void GivenGetAllUsersShouldReturnListOfAllUsers(){
//        productRepository.save(product1);
//        //stubbing mock to return specific data
//        when(productRepository.findAll()).thenReturn(productList);
//        List<Product> productList1 =productService.getAllProducts();
//        assertEquals(productList1,productList);
//        verify(productRepository,times(1)).save(product1);
//        verify(productRepository,times(1)).findAll();
//    }





    @Test
    public void test(){
        int x = 2;
        int y = 23;

        Assert.assertEquals(46, x * y);
    }
}
